### 附录A――密钥扩展示例  
本附录展示了每种密钥长度的密钥编排生成过程。请注意，多字节值采用第3节所述的表示法。密钥编排生成过程中产生的中间值（见第5.2节）如下表所示（除索引列（i）外，所有值均为十六进制格式）。

#### A.1 128位密钥的扩展  
本节包含以下密钥的扩展过程：  
密钥 = 2b 7e 15 16 28 ae d2 a6 ab f7 15 88 09 cf 4f 3c  
对于Nk=4，扩展结果为：  
w0 = 2b7e1516，w1 = 28aed2a6，w2 = abf71588，w3 = 09cf4f3c

| i（十进制） | temp | 经过ROTWORD()后 | 经过SUBWORD()后 | Rcon[i/Nk] | 与Rcon异或后 | w[i?Nk] | w[i] = temp  w[i?Nk] |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 4 | 09cf4f3c | cf4f3c09 | 8a84eb01 | 01000000 | 8b84eb01 | 2b7e1516 | a0fafe17 |
| 5 | a0fafe17 |  |  |  |  | 28aed2a6 | 88542cb1 |
| 6 | 88542cb1 |  |  |  |  | abf71588 | 23a33939 |
| 7 | 23a33939 |  |  |  |  | 09cf4f3c | 2a6c7605 |
| 8 | 2a6c7605 | 6c76052a | 50386be5 | 02000000 | 52386be5 | a0fafe17 | f2c295f2 |
| 9 | f2c295f2 |  |  |  |  | 88542cb1 | 7a96b943 |
| 10 | 7a96b943 |  |  |  |  | 23a33939 | 5935807a |
| 11 | 5935807a |  |  |  |  | 2a6c7605 | 7359f67f |
| 12 | 7359f67f | 59f67f73 | cb42d28f | 04000000 | cf42d28f | f2c295f2 | 3d80477d |
| 13 | 3d80477d |  |  |  |  | 7a96b943 | 4716fe3e |
| 14 | 4716fe3e |  |  |  |  | 5935807a | 1e237e44 |
| 15 | 1e237e44 |  |  |  |  | 7359f67f | 6d7a883b |
| 16 | 6d7a883b | 7a883b6d | dac4e23c | 08000000 | d2c4e23c | 3d80477d | ef44a541 |
| 17 | ef44a541 |  |  |  |  | 4716fe3e | a8525b7f |
| 18 | a8525b7f |  |  |  |  | 1e237e44 | b671253b |
| 19 | b671253b |  |  |  |  | 6d7a883b | db0bad00 |
| 20 | db0bad00 | 0bad00db | 2b9563b9 | 10000000 | 3b9563b9 | ef44a541 | d4d1c6f8 |
| 21 | d4d1c6f8 |  |  |  |  | a8525b7f | 7c839d87 |
| 22 | 7c839d87 |  |  |  |  | b671253b | caf2b8bc |
| 23 | caf2b8bc |  |  |  |  | db0bad00 | 11f915bc |


#### A.2 192位密钥的扩展  
本节包含以下密钥的扩展过程：  
密钥 = 8e 73 b0 f7 da 0e 64 52 c8 10 f3 2b 80 90 79 e5 62 f8 ea d2 52 2c 6b 7b  
对于Nk=6，扩展结果为：  
w0=8e73b0f7，w1=da0e6452，w2=c810f32b，  
w3=809079e5，w4=62f8ead2，w5=522c6b7b

| i（十进制） | temp | 经过ROTWORD()后 | 经过SUBWORD()后 | Rcon[i/Nk] | 与Rcon异或后 | w[i?Nk] | w[i] = temp  w[i?Nk] |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 6 | 522c6b7b | 2c6b7b52 | 717f2100 | 01000000 | 707f2100 | 8e73b0f7 | fe0c91f7 |
| 7 | fe0c91f7 |  |  |  |  | da0e6452 | 2402f5a5 |
| 8 | 2402f5a5 |  |  |  |  | c810f32b | ec12068e |


#### A.3 256位密钥的扩展  
本节包含以下密钥的扩展过程：  
密钥 = 60 3d eb 10 15 ca 71 be 2b 73 ae f0 85 7d 77 81 1f 35 2c 07 3b 61 08 d7 2d 98 10 a3 09 14 df f4  
对于Nk=8，扩展结果为：  
w0=603deb10，w1=15ca71be，w2=2b73aef0，w3=857d7781，  
w4=1f352c07，w5=3b6108d7，w6=2d9810a3，w7=0914dff4


### 附录B――密码示例  
下图展示了块长度和密钥长度均为16字节（即Nb=4，Nk=4）时，密码运行过程中状态数组的值。  
密钥 = 2b 7e 15 16 28 ae d2 a6 ab f7 15 88 09 cf 4f 3c  
输入 = 32 43 f6 a8 88 5a 30 8d 31 31 98 a2 e0 37 07 34  
轮密钥值取自附录A.1中的密钥扩展示例。


### 附录C――示例向量  
NIST计算机安全资源中心提供了一个网站，包含AES的“带中间值的示例”[8]。


### 附录D――变更日志（说明性）  
原始的FIPS 197（2001年11月26日）在NIST密码出版物审查委员会[9]的主持下进行了审查和更新。NIST IR 8319[10]中描述的公众对AES安全性的评论和分析，是决定维持本标准技术规范的依据。  

以下是2023年5月9日更新版（NIST FIPS 197-upd1）对原始FIPS 197的编辑性变更摘要：  

1. 改进了出版物中许多元素的格式，并修订了文本以提高清晰度。  
2. 在前言部分增加了以下内容：标题页、前言、摘要和关键词。标题页上的官员姓名和所属机构反映了原始出版物的情况。  
3. 公告部分已更新，以反映当前的法规、条例、标准、指南和验证计划。  
4. 第1节经过修订，1）增加并更新了关于AES开发工作的参考文献；2）明确命名了AES-128、AES-192和AES-256。  
5. 先前第2.2节（算法参数、符号和函数）的内容被拆分为两个新部分：2.2（函数列表）和2.3（算法参数和符号）。  
6. 规范中的术语、函数和符号已全面纳入第2.1-2.3节的列表中。  
7. 第3.1节中关于索引约定的描述已删除。  
8. 表1已修订，先前第3.2节中关于字节多项式解释的文本已修订并移至第4节。  
9. 在专门讨论块的示例之前，第3.3节增加了字节序列索引的一般定义，并且表2已修订。  
10. 第3.5节的标题已修改为聚焦于字数组，并在文本中纳入了相关符号。状态的列字以垂直格式呈现，并对索引进行了更清晰的描述。  
11. 第4节的脚注中增加了关于有限域特性的附加信息参考文献[4]，并且第4.1节和第4.2节的标题已修订为明确提及GF(2?)。  
12. 第4.2节经过修订，提供了有限域乘法的明确、一般描述。先前的第4.2.1节已纳入修订后的第4.2节，用使用xtime的有限域乘法示例取代了原始的多项式模约简示例。  
13. 第4.3节的标题已修订为聚焦于与固定矩阵的乘法，并且通过删除作为多项式约简的次要解释，简化了该节的文本。第5.1.3节和第5.3.3节中关于MIXCOLUMNS()和INVMIXCOLUMNS()的描述也相应修订，以引用此构造。  
14. 先前第4.2节中关于GF(2?)中乘法逆的文本已修订并移至新的第4.4节。  
15. 第5节中关于算法规范的讨论已扩展，以详细阐述其组件之间的关系。新增了关于Nb作为Rijndael参数的简要解释，使得在本标准的其余部分可以用其常数4替代Nb。  
16. 第5.1、5.2和5.3节中关于密码、密钥扩展程序和逆密码的伪代码已重新格式化，并且这些部分的一些文本已修订以提高清晰度。  
17. 第5.1.2节中关于SHIFTROWS()和第5.3.2节中关于INVSHIFTROWS()的描述已改进，并纠正了后者中的一个错误。  
18. 新图6、7和8中新增了三种密钥扩展实例的插图，并添加到第5.2节。该节的文本也经过修订，包括在新图5中明确显示轮常量。  
19. 在第5.3.5节中新增了一个用于等效逆密码的修改密钥扩展程序的单独算法，而非仅补充行。等效逆密码的描述已简化，转而引用更新的参考文献[3]。  
20. 第6.2节经过修订，纳入了对NIST特别出版物800-133修订版2[6]的引用。  
21. 第6.4节经过修订，扩展了关于实现攻击的讨论。  
22. 参考文献部分不再标记为附录。参考文献已更新，以替换已撤回的出版物并纠正引用信息和URL。  
23. 附录C中的示例已删除，转而引用现在维护在[8]的详细示例向量。  
24. 新增了附录D，以总结本次FIPS 197更新中的变更。